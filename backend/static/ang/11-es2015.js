(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{PgJR:function(t,e,n){"use strict";n.r(e),n.d(e,"EmployeeModule",(function(){return G}));var i=n("PCNd"),c=n("tyNb"),o=n("fXoL");let r=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Kb({type:t,selectors:[["employee-home"]],decls:2,vars:0,template:function(t,e){1&t&&(o.Wb(0,"p"),o.Gc(1,"home works!"),o.Vb())},styles:[""]}),t})();var s=n("wd/R"),a=n("eJuo"),p=n("eIep"),d=n("lJxs"),l=n("vyqY"),u=n("YZpF"),m=n("r32Y"),b=n("kt0X"),h=n("ofXK"),f=n("Nls1"),y=n("3Pt+"),D=n("iadO");function g(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",17),o.Wb(1,"p"),o.Gc(2),o.Vb(),o.Wb(3,"div",18),o.ec("click",(function(){o.yc(t);const n=e.$implicit;return o.ic().emitDate(n)})),o.Wb(4,"div",19),o.Gc(5),o.Vb(),o.Vb(),o.Vb()}if(2&t){const t=e.$implicit,n=o.ic();o.Db(2),o.Hc(t.format("ddd").toUpperCase()),o.Db(1),o.Hb("bg-primary",n.isCurrent(t)),o.Db(2),o.Ic(" ",t.format("DD")," ")}}function v(t,e){if(1&t){const t=o.Xb();o.Ub(0),o.Wb(1,"button",20),o.ec("click",(function(){o.yc(t);const e=o.ic();return e.add.emit(e.currentDate)})),o.Gc(2," New appointment "),o.Vb(),o.Rb(3,"hr"),o.Tb()}}let k=(()=>{class t{constructor(){this.updateCurrent=new o.o,this.add=new o.o}ngOnInit(){this.timeSpan=this.isMobile?2:3,this.startDate=s().utc().startOf("day").subtract(this.timeSpan,"day"),this.endDate=s().utc().startOf("day").add(this.timeSpan,"day")}dates(){const t=[];let e=s.utc(this.startDate.toISOString());for(;e.isBefore(this.endDate)||e.isSame(this.endDate);)t.push(s.utc(e.toISOString())),e=e.clone().add(1,"day");return t}isCurrent(t){return this.currentDate.format("DDMMYYYY")===t.format("DDMMYYYY")}emitDate(t){this.updateCurrent.emit(t),t.isAfter(this.endDate)&&(this.startDate=t,this.endDate=s.utc(t.toISOString()).add(2*this.timeSpan,"day")),t.isBefore(this.startDate)&&(this.startDate=s.utc(t.toISOString()).subtract(2*this.timeSpan,"day"),this.endDate=t)}nextDay(){this.emitDate(this.currentDate.clone().add(1,"day"))}previousDay(){this.emitDate(this.currentDate.clone().subtract(1,"day"))}availability(){const t=Object(f.c)(this.employee.scheduleModel,this.currentDate);return t.frames.length>0?t.frames.map(t=>t.name).reduce((t,e)=>t+" | "+e):"No Availability"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Kb({type:t,selectors:[["employee-schedule-page-header"]],inputs:{currentDate:"currentDate",appointments:"appointments",permissions:"permissions",employee:"employee",isMobile:"isMobile"},outputs:{updateCurrent:"updateCurrent",add:"add"},decls:25,vars:9,consts:[[1,"row"],[1,"col-12","h4","text-center"],[1,"col-12"],[1,"d-flex","c-primary","h3","text-center","mr-4","ml-4"],[1,"fa","fa-chevron-left","c-pointer",3,"click"],[1,"w-100"],[1,"fa","fa-chevron-right","c-pointer",3,"click"],[1,"d-flex","h4","text-center"],["class","date-box",4,"ngFor","ngForOf"],[1,"col-12","h5","text-center"],[1,"c-pointer",3,"click"],[1,"fa","fa-calendar","mr-2"],[1,"visually-hidden"],[3,"ngModel","matDatepicker","ngModelChange","click"],[3,"touchUi"],["dp",""],[4,"ngIf"],[1,"date-box"],[1,"day-round","c-pointer",3,"click"],[1,"inner"],[1,"btn","btn-primary",3,"click"]],template:function(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",0),o.Wb(1,"div",1),o.Gc(2),o.Vb(),o.Wb(3,"div",2),o.Wb(4,"div",3),o.Wb(5,"i",4),o.ec("click",(function(){return e.previousDay()})),o.Vb(),o.Wb(6,"span",5),o.Gc(7),o.Vb(),o.Wb(8,"i",6),o.ec("click",(function(){return e.nextDay()})),o.Vb(),o.Vb(),o.Vb(),o.Wb(9,"div",2),o.Wb(10,"div",7),o.Ec(11,g,6,4,"div",8),o.Vb(),o.Rb(12,"hr"),o.Vb(),o.Wb(13,"div",9),o.Wb(14,"div",10),o.ec("click",(function(){return o.yc(t),o.vc(20).open()})),o.Rb(15,"i",11),o.Gc(16),o.Vb(),o.Wb(17,"div",12),o.Wb(18,"input",13),o.ec("ngModelChange",(function(t){return e.emitDate(t)}))("click",(function(){return o.yc(t),o.vc(20).open()})),o.Vb(),o.Vb(),o.Rb(19,"mat-datepicker",14,15),o.Rb(21,"hr"),o.Gc(22),o.Rb(23,"hr"),o.Ec(24,v,4,0,"ng-container",16),o.Vb(),o.Vb()}if(2&t){const t=o.vc(20);o.Db(2),o.Ic(" ",e.employee.name," "),o.Db(5),o.Hc(e.currentDate.format("MMMM YYYY")),o.Db(4),o.oc("ngForOf",e.dates()),o.Db(5),o.Ic(" ",e.currentDate.format("dddd, DD MMMM YYYY")," "),o.Db(2),o.oc("ngModel",e.currentDate)("matDatepicker",t),o.Db(1),o.oc("touchUi",e.isMobile),o.Db(3),o.Ic(" ",e.availability()," "),o.Db(2),o.oc("ngIf",e.permissions.add)}},directives:[h.k,y.c,D.d,y.n,y.q,D.c,h.l],styles:["[_nghost-%COMP%]{display:block;position:-webkit-sticky;position:sticky;background-color:#fafafa;top:0;left:0;z-index:3}.date-box[_ngcontent-%COMP%]{flex:1}.pretty-scroll[_ngcontent-%COMP%]{overflow-y:scroll;max-height:30rem}.day-round[_ngcontent-%COMP%]{position:relative;margin:auto;width:4rem;height:4rem;border-radius:2rem}.inner[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),t})();var M=n("Xa2L"),V=n("Qu3c");function W(t,e){if(1&t){const t=o.Xb();o.Wb(0,"p"),o.Wb(1,"i",11),o.ec("click",(function(){return o.yc(t),o.ic().edit()})),o.Vb(),o.Vb()}}let w=(()=>{class t{constructor(t){this.store=t}customerDetails(){return this.appointment.customer.email+"\n"+this.appointment.customer.phone}edit(){this.store.dispatch(l.b.openAppointmentEventDialog({id:this.appointment.id,employeeMode:!0}))}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(b.h))},t.\u0275cmp=o.Kb({type:t,selectors:[["employee-schedule-appointment"]],inputs:{appointment:"appointment",showEdit:"showEdit"},decls:17,vars:7,consts:[[1,"schedule-appointment-container"],[1,"row"],[1,"col-2","text-center","m-auto","c-medium-gray"],[4,"ngIf"],[1,"col-6","m-auto"],[1,"m-auto"],[1,"col-4","c-medium-gray"],[1,"fa","fa-clock","c-primary","mr-2"],[1,"c-primary",3,"matTooltip","matTooltipClass"],[1,"fa","fa-address-card","mr-2"],[1,"col-12"],[1,"fa","fa-pen","c-primary","c-pointer",3,"click"]],template:function(t,e){1&t&&(o.Wb(0,"div",0),o.Wb(1,"div",1),o.Wb(2,"div",2),o.Gc(3),o.Ec(4,W,2,0,"p",3),o.Vb(),o.Wb(5,"div",4),o.Wb(6,"p",5),o.Gc(7),o.Vb(),o.Vb(),o.Wb(8,"div",6),o.Wb(9,"p"),o.Rb(10,"i",7),o.Gc(11),o.Vb(),o.Wb(12,"p",8),o.Rb(13,"i",9),o.Gc(14),o.Vb(),o.Vb(),o.Wb(15,"div",10),o.Rb(16,"hr"),o.Vb(),o.Vb(),o.Vb()),2&t&&(o.Db(3),o.Ic(" ",e.appointment.start.format("HH:mm")," "),o.Db(1),o.oc("ngIf",e.showEdit),o.Db(3),o.Ic(" ",e.appointment.service.name," "),o.Db(4),o.Ic(" ",e.appointment.service.duration," "),o.Db(1),o.oc("matTooltip",e.customerDetails())("matTooltipClass","tooltip-ws"),o.Db(2),o.Ic("",e.appointment.customer.name," "))},directives:[h.l,V.a],styles:[".schedule-appointment-container[_ngcontent-%COMP%]{font-weight:600;margin:0 15px}p[_ngcontent-%COMP%]{margin:0}"]}),t})();function C(t,e){1&t&&(o.Wb(0,"div",6),o.Rb(1,"mat-spinner"),o.Vb())}function I(t,e){if(1&t&&(o.Rb(0,"employee-schedule-appointment",8),o.jc(1,"async")),2&t){const t=e.$implicit,n=o.ic(3);o.oc("appointment",t)("showEdit",o.kc(1,2,n.permissions$).change)}}function O(t,e){if(1&t&&(o.Ec(0,I,2,4,"employee-schedule-appointment",7),o.jc(1,"async")),2&t){const t=o.ic(2);o.oc("ngForOf",o.kc(1,1,t.appointments$))}}function x(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",1),o.Wb(1,"div",2),o.Wb(2,"employee-schedule-page-header",3),o.ec("updateCurrent",(function(e){return o.yc(t),o.ic().updateCurrent(e)}))("add",(function(n){o.yc(t);const i=e.ngIf;return o.ic().openCreateDialog(n,i)})),o.jc(3,"async"),o.jc(4,"async"),o.jc(5,"async"),o.jc(6,"async"),o.Vb(),o.Ec(7,C,2,0,"div",4),o.jc(8,"async"),o.Ec(9,O,2,3,"ng-template",null,5,o.Fc),o.Vb(),o.Vb()}if(2&t){const t=e.ngIf,n=o.vc(10),i=o.ic();o.Db(2),o.oc("currentDate",o.kc(3,7,i.currentDate$))("appointments",o.kc(4,9,i.appointments$))("permissions",o.kc(5,11,i.permissions$))("employee",t)("isMobile",o.kc(6,13,i.isMobile$)),o.Db(5),o.oc("ngIf",o.kc(8,15,i.isLoading$))("ngIfElse",n)}}let E=(()=>{class t extends m.a{constructor(t){super(t)}ngOnInit(){this.initialize(),this.employee$=this.store.select(u.B),this.appointments$=this.employee$.pipe(Object(p.a)(t=>this.store.select(l.d.selectCurrentDateEmployeeAppointments,{employeeId:t.id}))),this.permissions$=this.store.select(u.z,{model:a.a.modelType}),this.currentDate$=this.store.select(l.d.selectCurrentDate).pipe(Object(d.a)(t=>s.utc(t))),this.isLoading$=this.store.select(l.d.getIsLoadingEntities)}initialize(){const t=s().utc().startOf("day");this.updateCurrent(t),this.loadAppointments(t)}updateCurrent(t){this.store.dispatch(l.b.setCurrentDate({date:t})),this.loadAppointments(t)}loadAppointments(t){const e={fromDate:s.utc(t).startOf("day"),toDate:s.utc(t).endOf("day")};this.store.dispatch(l.b.requestEntities({params:e}))}openCreateDialog(t,e){this.store.dispatch(l.b.openCreateAppointmentDialog({date:t,employee:e,employeeMode:!0}))}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(b.h))},t.\u0275cmp=o.Kb({type:t,selectors:[["employee-schedule-page"]],features:[o.Ab],decls:2,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"schedule-container"],[3,"currentDate","appointments","permissions","employee","isMobile","updateCurrent","add"],["class","d-flex justify-content-center",4,"ngIf","ngIfElse"],["appointments",""],[1,"d-flex","justify-content-center"],[3,"appointment","showEdit",4,"ngFor","ngForOf"],[3,"appointment","showEdit"]],template:function(t,e){1&t&&(o.Ec(0,x,11,17,"div",0),o.jc(1,"async")),2&t&&o.oc("ngIf",o.kc(1,1,e.employee$))},directives:[h.l,k,M.b,h.k,w],pipes:[h.b],styles:[".schedule-container[_ngcontent-%COMP%]{max-width:650px;position:relative}"],changeDetection:0}),t})(),Y=(()=>{class t{constructor(t){this.store=t}canActivate(t,e){return this.store.pipe(u.p,Object(d.a)(t=>!!t.employee))}}return t.\u0275fac=function(e){return new(e||t)(o.ac(b.h))},t.\u0275prov=o.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const $=[{path:"home",icon:"home",component:r,canActivate:[Y]},{path:"schedule",icon:"book",component:E,canActivate:[Y]},{path:"",icon:"",component:E,canActivate:[Y]}];var j=n("7Qvi");const R=[{path:"",icon:"",component:(()=>{class t{constructor(){this.routes=$}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Kb({type:t,selectors:[["employee-dashboard"]],decls:2,vars:1,consts:[[3,"routes"]],template:function(t,e){1&t&&(o.Wb(0,"shared-dashboard-container-shell",0),o.Rb(1,"router-outlet"),o.Vb()),2&t&&o.oc("routes",e.routes)},directives:[j.a,c.g],styles:[""]}),t})(),children:$}];let S=(()=>{class t{}return t.\u0275mod=o.Ob({type:t}),t.\u0275inj=o.Nb({factory:function(e){return new(e||t)},imports:[[c.f.forChild(R)],c.f]}),t})();var A=n("QiP+");let G=(()=>{class t{}return t.\u0275mod=o.Ob({type:t}),t.\u0275inj=o.Nb({factory:function(e){return new(e||t)},imports:[[i.a,S,A.a]]}),t})()}}]);